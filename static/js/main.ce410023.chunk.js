(this["webpackJsonpchange-clone"]=this["webpackJsonpchange-clone"]||[]).push([[0],{148:function(e,t,r){},167:function(e,t){},170:function(e,t){},171:function(e,t){},172:function(e,t){},173:function(e,t){},191:function(e,t){},751:function(e,t,r){"use strict";r.r(t);var n=r(2),s=r.n(n),a=r(44),c=r.n(a),i=(r(148),r(4)),o=r(13),l=r(8),u=r(1);function d(e){var t=e.children,r=e.clickAway;return Object(u.jsxs)("div",{className:"modal fixed w-full h-full top-0 left-0 flex items-center justify-center z-40",children:[Object(u.jsx)("div",{className:"modal-overlay absolute w-full h-full bg-black opacity-20 ",onClick:r}),t]})}var j=r(18),h=(r(752),r(140),r(7)),b=r.n(h),m=r(11),x=(r(49),r(34));r(753);j.a.initializeApp({apiKey:"AIzaSyD3I7PwWN-o2P-_auT_X_xmiry3ZYZvU7A",authDomain:"change-clone.firebaseapp.com",projectId:"change-clone",storageBucket:"change-clone.appspot.com",messagingSenderId:"817626444626",appId:"1:817626444626:web:6232d23f848f21ca59008b",measurementId:"G-5SMX89FECT"});var p=j.a.firestore(),f=j.a.storage(),O=function e(t,r,n,s,a){Object(x.a)(this,e),this.name=t,this.description=r,this.image=n,this.proposals=s,this.comments=a},g=f.ref().child("userImages"),v={toFirestore:function(e){return{name:e.name,description:e.description,image:e.image,proposals:e.proposals,comments:e.comments}},fromFirestore:function(e,t){var r=e.data(t);return new O(r.name,r.description,r.image,r.proposals,r.comments)}},w=function(e,t,r,n){return n?g.child(e).put(n).then((function(n){n.ref.getDownloadURL().then((function(n){p.collection("users").doc(e).withConverter(v).set(new O(t,r,n,[],[]))}))})):p.collection("users").doc(e).withConverter(v).set(new O(t,r,"https://firebasestorage.googleapis.com/v0/b/change-clone.appspot.com/o/userImages%2Fj5w9zTnBhHWRviOMTrUPBNlytBh2",[],[]))},y=function(){var e=Object(m.a)(b.a.mark((function e(t,r,n,s,a){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t&&r&&n&&s)){e.next=4;break}return e.abrupt("return",j.a.auth().createUserWithEmailAndPassword(t,r).then(function(){var e=Object(m.a)(b.a.mark((function e(t){var r;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.user,e.next=3,w(r.uid,n,s,a);case 3:return e.abrupt("return",r.uid);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){switch(e.code){case"auth/email-already-in-use":e.message="Email is already in use.";break;case"auth/invalid-email":e.message="Invalid email address.";break;case"weak-password":e.message="Please use a stronger password."}throw e})));case 4:throw new Error("Please check if all fields are filled in.");case 5:case"end":return e.stop()}}),e)})));return function(t,r,n,s,a){return e.apply(this,arguments)}}(),N=function(e){return p.collection("users").doc(e).withConverter(v).get().then((function(e){if(e.exists)return e.data();throw Error("User does not exist")})).catch((function(e){throw e}))},k=function(e,t){return j.a.auth().signInWithEmailAndPassword(e,t).then((function(e){return e.user.uid})).catch((function(e){switch(e.code){case"auth/wrong-password":e.message="That password does not match the email provided.";break;case"auth/user-disabled":e.message="Please contact support regarding your account.";break;case"auth/user-not-found":e.message="That email does not exist.";break;case"auth/invalid-email":e.message="Invalid email address."}throw e}))};function C(e){var t=e.onClick,r=e.type,n=e.text,s=e.styling,a=e.isLoading?"border-gray-300 bg-gray-300 text-gray-500":"bg-theme-red border-theme-red active:bg-white active:text-theme-red hover:bg-theme-red-dark text-theme-white";return Object(u.jsx)("button",{className:"py-2 px-3  font-bold rounded-md border-2  ".concat(s," ").concat(a),onClick:t,type:r,children:n})}var S,I=r(10),L=r(14),P=r(28),E=Object(P.b)("user/signIn",function(){var e=Object(m.a)(b.a.mark((function e(t){var r,n,s;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.email,n=t.password,e.next=3,k(r,n);case 3:return s=e.sent,e.abrupt("return",s);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),U=Object(P.b)("user/signOut",Object(m.a)(b.a.mark((function e(){var t;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.a.auth().signOut();case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}}),e)})))),A=Object(P.b)("user/initializeSignedIn",Object(m.a)(b.a.mark((function e(){var t;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(e,t){j.a.auth().onAuthStateChanged((function(t){e(!!t&&t.uid)}))}));case 2:if(!1===(t=e.sent)){e.next=7;break}return e.abrupt("return",t);case 7:return e.abrupt("return",0);case 8:case"end":return e.stop()}}),e)})))),R=Object(P.b)("user/signUp",function(){var e=Object(m.a)(b.a.mark((function e(t){var r,n,s,a,c,i;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.email,n=t.password,s=t.username,a=t.description,c=t.profileImage,e.next=3,y(r,n,s,a,c);case 3:return i=e.sent,e.abrupt("return",i);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),T=Object(P.c)({name:"user",initialState:{data:{uid:0},status:"noUser",error:{login:null,signup:null}},reducers:{loggedIn:{reducer:function(e,t){e.user.uid=t.payload,e.user.status="hasUser"},loggedOut:{reducer:function(e,t){e.user.uid=0,e.user.status="noUser"}}}},extraReducers:(S={},Object(L.a)(S,E.pending,(function(e,t){e.status="loading",e.error.login=null})),Object(L.a)(S,E.fulfilled,(function(e,t){e.status="hasUser",e.data.uid=t.payload,e.error.login=null})),Object(L.a)(S,E.rejected,(function(e,t){e.status="failed",console.log(t.error.message),e.error.login=t.error.message})),Object(L.a)(S,U.pending,(function(e,t){e.status="loading",e.error.login=null})),Object(L.a)(S,U.fulfilled,(function(e,t){e.status="noUser",e.data.uid=0,e.error.login=null})),Object(L.a)(S,U.rejected,(function(e,t){e.status="failed"})),Object(L.a)(S,A.pending,(function(e,t){e.status="loading",e.error.login=null})),Object(L.a)(S,A.fulfilled,(function(e,t){0===t.payload?(e.status="noUser",e.data.uid=0):(e.status="hasUser",e.data.uid=t.payload)})),Object(L.a)(S,A.rejected,(function(e,t){e.status="failed"})),Object(L.a)(S,R.pending,(function(e,t){e.status="loading",e.error.signup=null})),Object(L.a)(S,R.fulfilled,(function(e,t){e.status="hasUser",e.data.uid=t.payload,e.error.signup=null})),Object(L.a)(S,R.rejected,(function(e,t){e.status="failed",e.error.signup=t.error.message})),S)}),B=T.actions,F=(B.loggedIn,B.loggedOut,T.reducer),z=function(e){return e.user};function D(){var e=Object(n.useState)(""),t=Object(i.a)(e,2),r=t[0],s=t[1],a=Object(n.useState)(""),c=Object(i.a)(a,2),o=c[0],l=c[1],d=Object(n.useState)(""),j=Object(i.a)(d,2),h=j[0],b=j[1],m=Object(n.useState)(null),x=Object(i.a)(m,2),p=x[0],f=x[1],O=Object(n.useState)(""),g=Object(i.a)(O,2),v=g[0],w=g[1],y=Object(I.b)(),N=Object(I.c)(z),k=Object(n.useRef)(null),S=Object(n.useState)(null),L=Object(i.a)(S,2),P=L[0],E=L[1];Object(n.useEffect)((function(){if(P&&k.current){var e=k.current,t=e.getContext("2d"),r=new Image;r.src=P,r.onload=function(){var n=Math.min(r.height,r.width);e.width=150,e.height=150,console.log(r.height,r.width,n),t.imageSmoothingQuality="high",t.drawImage(r,Math.max(0,(r.width-n)/2),Math.max(0,(r.height-n)/2),n,n,0,0,150,150),k.current.toBlob((function(e){f(e)}))}}}),[P]);var U=function(e){var t=e.type,r=e.name,n=e.value,s=e.onChange,a=e.placeholder;return Object(u.jsx)("input",{className:"py-1 px-2 w-full active:border-gray-400",required:!0,type:t,name:r,value:n,onChange:s,placeholder:a})};return Object(u.jsxs)("form",{className:"flex flex-col mt-3",children:[Object(u.jsxs)("div",{className:"border rounded-sm border-gray-300 divide-y divide-y-gray-300",children:[U({type:"text",name:"Name",value:r,onChange:function(e){s(e.target.value)},placeholder:"Name"}),U({type:"email",name:"Email",value:h,onChange:function(e){b(e.target.value)},placeholder:"Email"}),U({type:"password",name:"password",value:o,onChange:function(e){l(e.target.value)},placeholder:"Password"}),Object(u.jsxs)("div",{className:"py-1 px-2 w-full active:border-gray-400 flex flex-col",children:[Object(u.jsx)("label",{className:"mb-1",htmlFor:"profileImage",children:"Upload a picture (optional):"}),Object(u.jsx)("input",{className:"text-sm",name:"profileImage",type:"file",onChange:function(e){if(e.target.files&&e.target.files.length>0){var t=new FileReader;t.addEventListener("load",(function(e){E(t.result)})),t.readAsDataURL(e.target.files[0])}},accept:"image/*",required:!0}),Object(u.jsx)("div",{className:"overflow-hidden rounded-full border-gray-300 border ".concat(P?"":"hidden"),style:{margin:"auto",width:"150px",height:"150px"},children:Object(u.jsx)("canvas",{ref:k,style:{margin:"auto",width:"150px",height:"150px"}})})]})]}),Object(u.jsx)("div",{className:"mt-3",children:Object(u.jsx)("textarea",{className:"long-text-area",name:"description",rows:"5",placeholder:"Description",onChange:function(e){w(e.target.value)},value:v,required:!0})}),Object(u.jsx)("div",{className:"h-3",children:Object(u.jsx)("p",{className:"text-xs text-red-800",children:N.error.signup})}),Object(u.jsx)("div",{className:"mt-4 flex justify-center",children:Object(u.jsx)(C,{type:"submit",onClick:function(e){e.preventDefault(),y(R({email:h,password:o,username:r,description:v,profileImage:p}))},text:"Submit",className:"w-full md:w-auto",isLoading:"loading"===N.status})})]})}function J(){var e=Object(n.useState)(""),t=Object(i.a)(e,2),r=t[0],s=t[1],a=Object(n.useState)(""),c=Object(i.a)(a,2),o=c[0],l=c[1],d=Object(I.c)(z),j=Object(I.b)(),h=function(e){var t=e.type,r=e.name,n=e.value,s=e.onChange,a=e.placeholder;return Object(u.jsx)("input",{className:"py-1 px-2 w-full active:border-gray-400",required:!0,type:t,name:r,value:n,onChange:s,placeholder:a})};return Object(u.jsxs)("form",{className:"flex flex-col mt-3",children:[Object(u.jsxs)("div",{className:"border rounded-sm border-gray-300 divide-y divide-y-gray-300",children:[h({type:"email",name:"Email",value:o,onChange:function(e){l(e.target.value)},placeholder:"Email"}),h({type:"password",name:"password",value:r,onChange:function(e){s(e.target.value)},placeholder:"Password"})]}),Object(u.jsx)("div",{className:"h-3",children:Object(u.jsx)("p",{className:"text-xs text-red-800",children:d.error.login})}),Object(u.jsx)("div",{className:"mt-4 flex justify-center",children:Object(u.jsx)(C,{type:"submit",onClick:function(e){e.preventDefault(),j(E({email:o,password:r}))},text:"Log In",className:"w-full md:w-auto"})})]})}function Q(e){var t=e.showLogin,r=e.closeLogin,s=Object(n.useState)(!1),a=Object(i.a)(s,2),c=a[0],o=a[1],l=function(e){var t=e.text;return Object(u.jsx)("button",{className:"text-theme-red underline",onClick:function(){o(!0^c)},children:t})};return t?Object(u.jsx)(d,{clickAway:r,children:Object(u.jsxs)("div",{className:"relative bg-white rounded m-auto w-full h-full max-w-full-sm z-50 animate-expand-fast md:w-96 md:h-auto",children:[Object(u.jsx)("button",{className:"absolute top-2 right-3 text-3xl md:text-xl",onClick:r,children:"\u2715"}),Object(u.jsx)("div",{className:"p-6",children:c?Object(u.jsxs)("div",{children:[Object(u.jsx)("h1",{className:"text-center mt-3",children:"Sign Up"}),Object(u.jsxs)("p",{className:"text-center mt-2 mb-6 pb-3 border-b border-gray-400",children:["Already have an account? ",Object(u.jsx)(l,{text:"Log in"})]}),Object(u.jsx)(D,{})]}):Object(u.jsxs)("div",{children:[Object(u.jsx)("h1",{className:"text-center mt-3",children:"Log In"}),Object(u.jsxs)("p",{className:"text-center mt-2 mb-6 pb-3 border-b border-gray-400",children:["Don't have an account? ",Object(u.jsx)(l,{text:"Sign up"})]}),Object(u.jsx)(J,{})]})})]})}):null}var q=r(61),V=function(){return Object(q.useMediaPredicate)("(min-width:960px)")},W=function(){return Object(q.useMediaPredicate)("(min-width:768px)")},Y=r.p+"static/media/user-icon.8f6c6dae.svg";function Z(e){var t=e.userId,r=e.styling,s=e.alt,a=e.disabled,c=Object(n.useState)(Y),o=Object(i.a)(c,2),d=o[0],j=o[1],h=Object(l.g)(),b=Object(n.useCallback)((function(){return h.push("/user/".concat(t))}),[h,t]);Object(n.useEffect)((function(){(function(e){return p.collection("users").doc(e).withConverter(v).get().then((function(e){if(e.exists){var t=e.data().image;return f.refFromURL(t)}throw Error("User does not exist")})).then((function(e){return e.getDownloadURL()}))})(t).then((function(e){j(e)})).catch((function(e){return console.log(e)}))}),[t]);return Object(u.jsx)("img",{src:d,className:"rounded-full  border border-gray-300 ".concat(r),alt:"".concat(s),onClick:a?function(){}:b})}function M(e){var t=e.userStatus,r=e.userId,n=e.showLogin,a=e.logOut;return V()?Object(u.jsxs)("ul",{className:"flex space-x-4 ml-10",children:[Object(u.jsx)("li",{children:Object(u.jsx)(o.b,{to:"/create_proposal",children:" Create Petition "})}),Object(u.jsx)("li",{children:Object(u.jsx)(o.b,{to:"/",children:" Browse "})})]}):Object(u.jsxs)("ul",{className:"space-y-2",children:[Object(u.jsx)("li",{children:Object(u.jsx)(o.b,{to:"/proposals",children:" Browse "})}),"hasUser"===t?Object(u.jsxs)(s.a.Fragment,{children:[Object(u.jsx)("li",{children:Object(u.jsx)(o.b,{to:"/create_proposal",children:" Create Petition "})}),Object(u.jsx)("li",{children:Object(u.jsx)(o.b,{to:"/user/".concat(r),children:" My Page "})}),Object(u.jsx)("li",{children:Object(u.jsx)("button",{onClick:a,children:" Sign Out "})})]}):Object(u.jsx)("li",{children:Object(u.jsx)("button",{onClick:n,children:" Log in or sign up"})})]})}function K(e){var t=e.showLogin,r=V(),s=Object(n.useState)(!1),a=Object(i.a)(s,2),c=a[0],d=a[1],j=Object(I.c)(z),h=Object(I.b)(),b=Object(l.g)(),m=function(e){e.preventDefault(),h(U()).then((function(){b.push("/")}))};function x(){d(!0^c)}var p=function(){return Object(u.jsx)(o.b,{to:"/",children:Object(u.jsx)("p",{className:"text-3xl font-bold text-theme-red tracking-tighter",children:"change.org"})})},f=function(){return c?r?Object(u.jsx)("div",{className:"fixed h-full w-full top-0 z-40",onClick:x,children:Object(u.jsx)("div",{className:"relative h-full w-960px top-0 z-40 mx-auto",children:Object(u.jsxs)("div",{className:"absolute top-12 right-4 z-40",children:[Object(u.jsx)("div",{className:"triangle border-b border-white empty-content-before float-right z-50 mr-1"}),Object(u.jsx)("div",{className:"mt-2 shadow-lg bg-white p-3 text-lg border border-gray-300 rounded-sm ",children:"hasUser"===j.status?Object(u.jsxs)("ul",{className:"space-y-2 py-2 px-1 text-sm",children:[Object(u.jsx)("li",{children:Object(u.jsx)(o.b,{to:"/create_proposal",children:" Create Petition "})}),Object(u.jsx)("li",{children:Object(u.jsx)(o.b,{to:"/user/".concat(j.data.uid),children:" My Page "})}),Object(u.jsx)("li",{children:Object(u.jsx)("span",{className:"w-full border-b border-gray-400"})}),Object(u.jsx)("li",{children:Object(u.jsxs)("button",{className:"underline text-theme-red hover:text-theme-black",onClick:m,children:[" ","Sign Out"," "]})})]}):Object(u.jsx)("ul",{children:Object(u.jsx)("li",{children:Object(u.jsx)("button",{onClick:t,children:" Log in or sign up"})})})})]})})}):Object(u.jsx)("div",{className:"fixed h-full w-full top-0 z-40",onClick:x,children:Object(u.jsxs)("div",{className:"fixed top-12 right-2 z-40",children:[Object(u.jsx)("div",{className:"triangle border-b border-white empty-content-before float-right z-50 mr-2"}),Object(u.jsx)("div",{className:"mt-2 shadow-lg bg-white p-3 text-lg border border-gray-300 rounded-sm ",children:Object(u.jsx)(M,{userStatus:j.status,userId:j.data.uid,showLogin:t,logOut:m})})]})}):null};return r?Object(u.jsxs)("nav",{className:"fixed top-0 left-0 z-30 h-14 w-full flex flex-row shadow bg-white",children:[Object(u.jsx)("div",{className:"w-960px px-3 m-auto",children:Object(u.jsxs)("div",{className:"flex flex-row items-center justify-between self-start",children:[Object(u.jsxs)("div",{className:"flex items-center",children:[Object(u.jsx)(p,{}),Object(u.jsx)(M,{userStatus:j.status,userId:j.data.uid,showLogin:t,logOut:m})]}),"hasUser"===j.status?Object(u.jsx)("div",{className:"cursor-pointer",onClick:x,children:Object(u.jsx)(Z,{userId:j.data.uid,styling:"h-9 w-9 rounded-full",disabled:!0})}):Object(u.jsxs)("button",{className:"hover:text-theme-red",onClick:t,children:[" ","Log in"]})]})}),Object(u.jsx)(f,{})]}):Object(u.jsxs)("nav",{className:"fixed top-0 left-0 z-30 h-14 w-full flex flex-row shadow bg-white",children:[Object(u.jsx)("div",{className:"w-full px-3 m-auto",children:Object(u.jsxs)("div",{className:"flex flex-row items-center justify-between self-start",children:[Object(u.jsx)(p,{}),Object(u.jsxs)("div",{className:"flex flex-row space-x-3",children:["hasUser"===j.status?Object(u.jsx)(Z,{userId:j.data.uid,styling:"h-10 w-10 rounded-full"}):null,Object(u.jsx)("button",{className:"text-2xl ",onClick:x,children:"\u2630"})]})]})}),Object(u.jsx)(f,{})]})}var H=r(32),G=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",c=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[],i=arguments.length>6&&void 0!==arguments[6]?arguments[6]:[],o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:[];Object(x.a)(this,e),this.title=t,this.description=r,this.image=n,this.target=s,this.author=a,this.supporters=c,this.amendments=i,this.discussions=o},X=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;Object(x.a)(this,e),this.author=t,this.comment=r,this.likes=n},_=p.collection("discussions"),$={toFirestore:function(e){return{comment:e.comment,likes:e.likes,author:e.author}},fromFirestore:function(e,t){var r=e.data(t);return new X(r.author,r.comment,r.likes.length)}},ee=function(){var e=Object(m.a)(b.a.mark((function e(t,r){var n;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_.doc(t).collection("comments").withConverter($).add(r);case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),te=function(){var e=Object(m.a)(b.a.mark((function e(t,r){var n;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=_.doc(t).collection("comments").limit(25),e.next=3,n.withConverter($).onSnapshot((function(e){var t=[];e.forEach((function(e){return t.push(e.data())})),r(t)}));case 3:e.sent;case 4:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),re=p.collection("proposals"),ne=f.ref().child("proposalImages"),se={toFirestore:function(e){return{title:e.title,description:e.description,image:e.image,target:e.target,author:e.author,supporters:e.supporters,amendments:e.amendments,discussions:e.discussions}},fromFirestore:function(e,t){var r=e.data(t);return new G(r.title,r.description,r.image,r.target,r.author,r.supporters,r.amendments,r.discussions)}},ae=function(){var e=Object(m.a)(b.a.mark((function e(t,r){var n,s,a,c;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,re.withConverter(se).add(t);case 2:return n=e.sent,s=ne.child(n.id),e.next=6,s.put(r);case 6:return a=e.sent,e.next=9,a.ref.getDownloadURL();case 9:return c=e.sent,e.next=12,n.update({image:c});case 12:return e.abrupt("return",n.id);case 13:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),ce=function(){var e=Object(m.a)(b.a.mark((function e(t,r,n){var s;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=re.doc(t),e.abrupt("return",s.withConverter(se).onSnapshot((function(e){e.exists?r(e.data()):n(Error("Proposal does not exist"))})));case 2:case"end":return e.stop()}}),e)})));return function(t,r,n){return e.apply(this,arguments)}}(),ie=function(){var e=Object(m.a)(b.a.mark((function e(t){var r,n;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,re.doc(t).withConverter(se).get();case 2:if(!(r=e.sent).exists){e.next=6;break}return n=f.refFromURL(r.data().image),e.abrupt("return",n.getDownloadURL());case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),oe=function(){var e=Object(m.a)(b.a.mark((function e(t){var r,n;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==(r=j.a.auth().currentUser)){e.next=8;break}return n=re.doc(t),e.next=5,n.update({supporters:j.a.firestore.FieldValue.arrayUnion(r.uid)});case 5:return e.abrupt("return");case 8:throw new Error("User not signed in");case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),le=function(){var e=Object(m.a)(b.a.mark((function e(){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",re.get().then((function(e){return e.size})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ue=function(){var e=Object(m.a)(b.a.mark((function e(t){var r,n,s,a,c,i;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=10;break}return e.next=3,re.startAfter(t).limit(4).withConverter(se).get();case 3:return r=e.sent,n=[],s=[],r.forEach((function(e){n.push(e.data()),s.push(e.id)})),e.abrupt("return",{proposals:n,ids:s,lastProposal:r.docs[[r.docs.length-1]]});case 10:return e.next=12,re.limit(4).withConverter(se).get();case 12:return a=e.sent,c=[],i=[],a.forEach((function(e){c.push(e.data()),i.push(e.id)})),e.abrupt("return",{proposals:c,ids:i,lastProposal:a.docs[a.docs.length-1]});case 17:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),de=r(31);function je(e){var t=e.proposalId,r=e.styling,s=e.alt,a=(e.height,e.width,Object(n.useState)()),c=Object(i.a)(a,2),o=c[0],d=c[1],j=Object(l.g)(),h=Object(n.useCallback)((function(){return j.push("/proposal/".concat(t))}),[j,t]);return Object(n.useEffect)((function(){ie(t).then((function(e){d(e)})).catch((function(e){console.log(e)}))}),[t]),o?Object(u.jsx)("img",{src:o,className:"".concat(r),alt:"".concat(s),onClick:h}):Object(u.jsxs)(de.c,{viewBox:"0 0 16 9",children:[" ",Object(u.jsx)("rect",{x:"0",y:"0",height:"9",width:"16"})]})}var he=r.p+"static/media/people.f996517d.svg";function be(e){var t=e.proposal,r=e.proposalId,s=new Intl.NumberFormat,a=Object(n.useState)("..."),c=Object(i.a)(a,2),o=c[0],d=c[1],j=Object(l.g)(),h=W();Object(n.useEffect)((function(){N(t.author).then((function(e){return d(e.name)}))}),[t.author]);var b=function(){j.push("/proposal/".concat(r))};return h?Object(u.jsxs)("div",{className:"bg-white border-gray-300 border-t border-b px-4 py-4 text-xs md:border md:rounded-md cursor-pointer",onClick:b,children:[Object(u.jsxs)("div",{className:"grid grid-cols-cardLeftPhoto space-x-3",children:[Object(u.jsxs)("div",{className:"space-y-1",children:[Object(u.jsxs)("p",{className:"text-gray-500 truncate",children:["Petition to ",t.target]}),Object(u.jsx)("h2",{children:t.title}),Object(u.jsxs)("div",{className:"relative",children:[Object(u.jsx)("p",{className:"line-clamp-3",children:t.description}),Object(u.jsx)("p",{className:"underline absolute bottom-0 right-0 z-10 text-theme-red pl-20 bg-gradient-to-l from-white via-white to-transparent",children:"Read more"})]})]}),Object(u.jsx)("div",{className:"px-2 flex items-center justify-center",children:Object(u.jsx)(je,{proposalId:r,styling:"object-cover w-142px h-142px"})})]}),Object(u.jsxs)("div",{className:"mt-3 flex items-center",children:[Object(u.jsx)(Z,{userId:t.author,styling:"w-8"}),Object(u.jsx)("b",{className:"ml-2",children:o}),Object(u.jsxs)("p",{className:"mr-0 ml-auto",children:[Object(u.jsx)("img",{src:he,className:"h-4 inline mr-2 self-center",alt:"Supporters icon"}),s.format(t.supporters.length)," supporters"]})]})]}):Object(u.jsxs)("div",{className:"bg-white border-gray-300 border-t border-b px-4 py-4 text-xs md:border md:rounded-md",onClick:b,children:[Object(u.jsxs)("p",{className:"text-gray-500 truncate",children:["Petition to ",t.target]}),Object(u.jsx)("h2",{className:"mb-4",children:t.title}),Object(u.jsx)("div",{className:"px-2 mb-6",children:Object(u.jsx)(je,{proposalId:r})}),Object(u.jsx)("p",{className:"mb-2 line-clamp-3",children:t.description}),Object(u.jsxs)("div",{className:"flex items-center",children:[Object(u.jsx)(Z,{userId:t.author,styling:"w-8"}),Object(u.jsx)("b",{className:"ml-2",children:o}),Object(u.jsxs)("p",{className:"mr-0 ml-auto",children:[Object(u.jsx)("img",{src:he,className:"h-4 inline mr-2 self-center",alt:"Supporters icon"}),s.format(t.supporters.length)," supporters"]})]})]})}function me(e){var t=e.onClick,r=e.type,n=e.text,s=e.styling;return Object(u.jsx)("button",{className:"bg-theme-white border-2 border-gray-400 hover:border-gray-600 py-2 px-4 text-theme-black  font-bold rounded-md ".concat(s),onClick:t,type:r,children:n})}function xe(){var e=Object(n.useState)(),t=Object(i.a)(e,2),r=t[0],s=t[1],a=Object(n.useState)(),c=Object(i.a)(a,2),o=c[0],l=c[1],d=Object(n.useState)(),j=Object(i.a)(d,2),h=j[0],x=j[1],p=Object(n.useState)("loading"),f=Object(i.a)(p,2),O=f[0],g=f[1],v=Object(n.useState)(0),w=Object(i.a)(v,2),y=w[0],N=w[1];Object(n.useEffect)((function(){(function(){var e=Object(m.a)(b.a.mark((function e(){var t,r,n,a,c;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,le();case 2:return t=e.sent,N(t),e.next=6,ue();case 6:r=e.sent,n=r.proposals,a=r.lastProposal,c=r.ids,s(n),l(a),x(c),g("completed");case 14:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[]);var k=function(){var e=Object(m.a)(b.a.mark((function e(){var t,n,a,c;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ue(o);case 2:t=e.sent,n=t.proposals,a=t.lastProposal,c=t.ids,s([].concat(Object(H.a)(r),Object(H.a)(n))),x([].concat(Object(H.a)(h),Object(H.a)(c))),l(a);case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return"completed"===O?Object(u.jsxs)("div",{className:"space-y-6 md:space-y-10 md:mx-5",children:[r.map((function(e,t){return Object(u.jsx)(be,{proposal:e,proposalId:h[t]},t)})),r.length>=y?null:Object(u.jsx)(me,{onClick:k,styling:"w-full",text:"Load more"})]}):"loading"===O?Object(u.jsx)("div",{className:"h-48",children:Object(u.jsx)(de.a,{})}):null}var pe=r.p+"static/media/world-map.13cd6ad0.webp";function fe(){var e=Object(l.g)();return Object(u.jsxs)("div",{children:[Object(u.jsxs)("div",{className:"py-28 flex-col items-center leading-snug text-center bg-top bg-cover bg-no-repeat md:bg-contain",style:{backgroundImage:"url(".concat(pe,")")},children:[Object(u.jsx)("h1",{className:"text-5xl mx-5 md:w-768px md:mx-auto",children:"The world's platform for change."}),Object(u.jsx)("p",{className:"text-theme-red mt-5",children:"Victories every day."}),Object(u.jsx)(C,{onClick:function(){e.push("/create_proposal")},text:"Start a petition",styling:"mt-5"})]}),Object(u.jsxs)("div",{className:"bg-gray-100 py-4 md:pt-10 md:mx-auto md:bg-white md:w-768px ",children:[Object(u.jsx)("h2",{className:"mx-2 mb-4 md:mb-4 md:mx-5",children:"What's happening on change.org"}),Object(u.jsx)(xe,{})]})]})}function Oe(e){var t=e.discussion,r=Object(n.useState)(""),s=Object(i.a)(r,2),a=s[0],c=s[1];return Object(n.useEffect)((function(){N(t.author).then((function(e){c(e.name)}))}),[t]),Object(u.jsxs)("div",{className:"bg-white p-2 md:pt-4 rounded-sm space-y-2",children:[Object(u.jsxs)("div",{className:"flex space-x-2 items-center",children:[Object(u.jsx)(Z,{userId:t.author,styling:"w-10"}),Object(u.jsx)(o.b,{to:"/user/".concat(t.author),children:Object(u.jsx)("b",{children:a})})]}),Object(u.jsx)("p",{children:t.comment})]})}function ge(e){var t=e.comment,r=e.error,n=e.changeComment,s=e.submitComment,a=e.closeForm;return Object(u.jsx)("div",{className:"w-full pt-2",children:Object(u.jsxs)("form",{children:[Object(u.jsx)("textarea",{className:"w-full text-theme-black",name:"comment",rows:"3",placeholder:"I'm signing because...",onChange:n,value:t}),Object(u.jsx)("div",{className:"text-sm text-red-800 mb-2",children:r}),Object(u.jsxs)("div",{className:"flex justify-between space-x-3",children:[Object(u.jsx)(C,{type:"submit",onClick:s,text:"Submit",styling:"w-full h-9 text-sm"}),Object(u.jsx)(me,{type:"button",onClick:a,text:"Cancel",styling:"w-full h-9 text-sm flex items-center justify-center"})]})]})})}function ve(e){var t=e.proposalId,r=e.closeForm,s=Object(I.c)(z),a=Object(n.useState)(""),c=Object(i.a)(a,2),o=c[0],l=c[1],d=Object(n.useState)(""),j=Object(i.a)(d,2),h=j[0],b=j[1];return"hasUser"!==s.status?null:Object(u.jsx)(ge,{comment:o,changeComment:function(e){l(e.target.value)},submitComment:function(e){e.preventDefault(),o||b("Please enter a comment."),"hasUser"===s.status&&o&&ee(t,new X(s.data.uid,o)).then(r)},closeForm:r,error:h})}function we(e){var t=e.proposalId,r=e.showLogin,s=Object(n.useState)(null),a=Object(i.a)(s,2),c=a[0],o=a[1],l=Object(n.useState)("loading"),d=Object(i.a)(l,2),j=d[0],h=d[1],b=Object(n.useState)(!1),m=Object(i.a)(b,2),x=m[0],p=m[1],f=Object(I.c)(z),O=function(e){o(e),h("completed")};Object(n.useEffect)((function(){te(t,O)}),[t]);var g=function(){"hasUser"===f.status?x||p(!0):r()};return Object(u.jsxs)("div",{className:"w-full bg-gray-200 px-4 py-6 space-y-4 md:bg-white md:px-0",children:[Object(u.jsx)("h2",{children:"Discussions"}),Object(u.jsxs)("div",{onClick:g,className:"transition-all duration-75 bg-white rounded-sm text-gray-400 w-full flex space-x-4 p-2 items-center md:border-b-2 md:pb-4",children:["hasUser"===f.status?Object(u.jsx)(Z,{userId:f.data.uid,disabled:!0,styling:"w-10 self-start"}):Object(u.jsx)("img",{src:"data:image/png;base64,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",className:"w-10 rounded-full  border border-gray-300",alt:"Current user"}),x?Object(u.jsx)(ve,{proposalId:t,closeForm:function(){return p(!1)}}):Object(u.jsx)("p",{children:"I'm signing because..."})]}),Object(u.jsx)("div",{className:"space-y-4 md:divide-y-2 md:space-y-3",children:"loading"===j?null:c.map((function(e,t){return Object(u.jsx)(Oe,{discussion:e},t)}))})]})}function ye(e){var t=e.numberOfSupporters,r=e.hasSigned,n=new Intl.NumberFormat,s=W(),a=[500,1e3,2500,5e3,1e4,5e4,1e5].find((function(e){return e>t})),c=Math.round(t/a*100),i=n.format(a-t),o=r?"Thanks to your support, this petition has a chance of winning! We only need ".concat(i," more signatures to reach the next goal - please share the petition to help!"):"We only need ".concat(i," more signatures to reach the next goal - can you help?");return s?Object(u.jsxs)("div",{className:"mb-4",children:[Object(u.jsxs)("p",{children:[Object(u.jsxs)("b",{children:[Object(u.jsx)("span",{children:n.format(t)})," have signed."]})," ","Let's get to ",n.format(a),"!"]}),Object(u.jsx)("div",{className:"w-full bg-gray-300 h-3 rounded-full mt-3",children:Object(u.jsx)("div",{className:"bg-gradient-to-r from-yellow-400 to-theme-red h-3 rounded-full z-10",style:{width:"".concat(c,"%")}})}),Object(u.jsx)("span",{className:"w-11/12 border-b-2 border-gray-300 mx-auto mt-5 block"}),Object(u.jsx)("p",{className:"mt-3",children:o})]}):Object(u.jsxs)("div",{children:[Object(u.jsxs)("p",{children:[Object(u.jsxs)("b",{children:[Object(u.jsx)("span",{children:n.format(t)})," have signed."]})," ","Let's get to ",n.format(a),"!"]}),Object(u.jsx)("div",{className:"w-full bg-gray-300 h-3 rounded-full my-2",children:Object(u.jsx)("div",{className:"bg-gradient-to-r from-yellow-400 to-theme-red h-3 rounded-full z-10",style:{width:"".concat(c,"%")}})})]})}function Ne(e){var t=e.showLogin,r=Object(I.c)(z),s=Object(l.h)().proposalId,a=Object(n.useState)(),c=Object(i.a)(a,2),d=c[0],j=c[1],h=Object(n.useState)(),b=Object(i.a)(h,2),m=b[0],x=b[1],p=Object(n.useState)("loading"),f=Object(i.a)(p,2),O=f[0],g=f[1],v=Object(l.g)(),w=W();Object(n.useEffect)((function(){ce(s,(function(e){j(e),N(e.author).then((function(e){x(e),g("completed")}))}),(function(e){return v.push("/404")}))}),[s,v]);var y=function(){return Object(u.jsxs)("div",{className:"flex justify-start items-center space-x-3 py-2",children:[Object(u.jsx)(Z,{userId:d.author,styling:"w-10"}),Object(u.jsx)("p",{className:"font-bold text-sm text-gray-600 md:text-xs",children:Object(u.jsxs)(o.b,{to:"/user/".concat(d.author),children:[Object(u.jsx)("u",{children:m.name})," started this petition to"," ",Object(u.jsx)("u",{children:d.target})]})})]})},k=function(){return Object(u.jsxs)("div",{children:[Object(u.jsxs)("div",{className:"border-b border-gray-300 space-y-2 w-full px-4 pb-2",children:[Object(u.jsxs)("h1",{children:[" ",d.title," "]}),Object(u.jsx)(ye,{numberOfSupporters:d.supporters.length}),y()]}),Object(u.jsx)("div",{className:"border-b border-gray-300 px-4 text-lg py-5 whitespace-pre-wrap pb-5",children:d.description})]})},S=function(){"hasUser"===r.status?oe(s):t()},L=function(){return d.supporters.includes(r.data.uid)},P=function(){return"hasUser"===r.status&&"completed"===O&&L()?Object(u.jsx)(C,{text:"\u2714 Thank you for signing!",onClick:function(){},styling:"w-full m-auto h-12 md:h-10 md:text-sm md:px-2"}):Object(u.jsx)(C,{text:"Sign this petition",onClick:S,styling:"w-full m-auto h-12 md:h-10"})};return w?Object(u.jsx)("div",{children:"loading"===O?Object(u.jsx)("div",{className:"w-768px mt-32 mx-auto",children:Object(u.jsx)(de.a,{})}):Object(u.jsxs)("div",{className:"w-768px px-10 mt-24 mx-auto xl:w-1024px",children:[Object(u.jsx)("h1",{className:"text-center",children:d.title}),Object(u.jsxs)("div",{className:"w-full mt-10 grid grid-cols-cardLeftPhoto",children:[Object(u.jsxs)("div",{className:"pr-10",children:[Object(u.jsx)(je,{proposalId:s,styling:"w-full",height:"9",width:"16"}),y(),Object(u.jsx)("div",{className:"text-lg py-5 whitespace-pre-wrap pb-5",children:d.description}),Object(u.jsx)(we,{proposalId:s,showLogin:t})]}),Object(u.jsx)("div",{children:Object(u.jsxs)("div",{className:"bg-gray-100 p-4 rounded sticky top-20",children:[Object(u.jsx)(ye,{numberOfSupporters:d.supporters.length,hasSigned:L()}),Object(u.jsx)(P,{})]})})]})]})}):Object(u.jsxs)("div",{children:[Object(u.jsx)(je,{proposalId:s,styling:"w-full",height:"9",width:"16"}),Object(u.jsx)("div",{className:"mt-4 mb-20",children:"loading"===O?Object(u.jsx)("div",{className:"w-full m-auto",children:Object(u.jsx)(de.b,{})}):Object(u.jsxs)("div",{children:[Object(u.jsx)(k,{}),Object(u.jsx)(we,{proposalId:s,showLogin:t})]})}),Object(u.jsx)("div",{className:"fixed bottom-0 h-16 py-2 px-3 bg-gray-100 border-t border-gray-300 w-full",children:P()})]})}function ke(e,t,r){return"loading"===e?Object(u.jsx)("h1",{children:"Loading..."}):Object(u.jsxs)("div",{children:[Object(u.jsxs)("div",{className:"flex flex-col pb-3 px-3 mx-8 justify-between items-center",children:[Object(u.jsx)(Z,{userId:r,styling:"w-36 rounded-full border-2 border-gray-400"}),Object(u.jsx)("div",{className:"flex flex-col justify-start mt-6",children:Object(u.jsx)("h1",{className:"text-3xl",children:t.name})})]}),Object(u.jsx)("span",{className:"block w-9 m-auto border-b-2 border-gray-300"}),Object(u.jsx)("div",{className:"mt-6 flex flex-col text-center pb-10 mx-5 md:mx-10",children:Object(u.jsx)("p",{children:t.description})})]})}function Ce(e){var t=e.match.params.userId,r=Object(n.useState)(),s=Object(i.a)(r,2),a=s[0],c=s[1],o=Object(n.useState)("loading"),d=Object(i.a)(o,2),j=d[0],h=d[1],b=Object(l.g)();return Object(n.useEffect)((function(){N(t).then((function(e){c(e),h("completed")})).catch((function(e){return b.push("/404")}))}),[t,b]),Object(u.jsx)("div",{children:Object(u.jsx)("div",{className:"pt-8 px-4 mx-2 border-b-2 border-gray-300 md:mx-auto md:w-768px",children:ke(j,a,t)})})}var Se=r(27);function Ie(e){var t=e.description,r=e.setDescription,s=e.recommendedLength,a=e.next,c=Object(n.useState)(""),o=Object(i.a)(c,2),l=o[0],d=o[1];return Object(u.jsxs)("div",{children:[Object(u.jsx)("h1",{className:"text-3xl mb-2",children:"Explain the problem you want to solve"}),Object(u.jsx)("p",{className:"mb-4",children:"People are more likely to support your petition if it\u2019s clear why you care. Explain how this change will impact you, your family, or your community."}),Object(u.jsx)("textarea",{name:"description",className:"long-text-area",rows:"10",value:t,placeholder:"Petition description",onChange:function(e){d(""),r(e.target.value)}}),Object(u.jsxs)("div",{className:"mt-2",children:[Object(u.jsx)("p",{className:"text-s text-red-800",children:l}),function(e,r){return e>0&&e<r?Object(u.jsxs)("p",{className:"text-s",children:["Great \u2014 you've started writing your petition. We recommend adding another",Object(u.jsx)("span",{className:"text-theme-red font-bold",children:" ".concat(r-t.length," ")}),"more characters before you finish \u2014 keep going!"]}):e>r?Object(u.jsxs)("p",{className:"text-s",children:["Great \u2014 your petition is currently",Object(u.jsx)("span",{className:"text-green-400 font-bold",children:" ".concat(t.length," ")}),"characters long \u2014 that\u2019s within the description length of some of the most successful petitions!"]}):Object(u.jsx)("p",{className:"text-s",children:"The most successful petitions tend to be at least 3 paragraphs long (about 1,000 characters in length)"})}(t.length,s)]}),Object(u.jsx)("div",{className:"md:flex md:justify-end md:mb-3",children:Object(u.jsx)(C,{text:"Continue",styling:"w-full mt-4 md:w-min md:float-right",onClick:function(){t.length?a():d("Please tell your story.")}})})]})}r(160);var Le=r(143),Pe=r.n(Le);r(161);function Ee(e){e.photo;var t,r,s=e.setPhoto,a=e.next,c=Object(n.useState)(null),o=Object(i.a)(c,2),l=o[0],d=o[1],j=Object(n.useRef)(null),h=Object(n.useRef)(null),b=Object(n.useState)({unit:"%",width:50,aspect:16/9}),m=Object(i.a)(b,2),x=m[0],p=m[1],f=Object(n.useState)(null),O=Object(i.a)(f,2),g=O[0],v=O[1],w=Object(n.useState)(""),y=Object(i.a)(w,2),N=y[0],k=y[1],S=Object(n.useState)(!1),I=Object(i.a)(S,2),L=I[0],P=I[1],E=Object(n.useCallback)((function(e){j.current=e}),[]);return Object(n.useEffect)((function(){if(g&&h.current&&j.current){var e=j.current,t=h.current,r=g,n=e.naturalWidth/e.width,a=e.naturalHeight/e.height,c=t.getContext("2d"),i=window.devicePixelRatio;t.width=r.width*i,t.height=r.height*i,c.setTransform(i,0,0,i,0,0),c.imageSmoothingQuality="high",c.drawImage(e,r.x*n,r.y*a,r.width*n,r.height*a,0,0,r.width,r.height),h.current.toBlob((function(e){s(e)}))}}),[g,s]),Object(u.jsxs)("div",{children:[Object(u.jsx)("h1",{className:"text-3xl mb-2",children:"Add a photo or video"}),Object(u.jsxs)("p",{className:"mb-4",children:["Petitions with a photo or video receive ",Object(u.jsx)("b",{children:" six times "})," more signatures than those without. Include one that captures the emotion of your story."]}),Object(u.jsxs)("div",{className:"mx-3 pt-2",children:[Object(u.jsxs)("div",{className:"mx-auto w-full border border-gray-400 rounded p-2",children:[Object(u.jsx)("div",{className:"flex justify-center",children:Object(u.jsx)(Pe.a,{src:l,onImageLoaded:E,crop:x,onChange:function(e){return p(e)},onComplete:function(e){return v(e)},imageStyle:{"max-height":"500px"}})}),Object(u.jsxs)("div",{children:[Object(u.jsx)("label",{htmlFor:"file-upload",className:"bg-theme-white border-2 border-gray-400 hover:border-gray-600 py-2 px-4 text-theme-black font-bold rounded-md block my-3 text-center md:w-max md:mx-auto",children:"Upload a picture"}),Object(u.jsx)("input",{id:"file-upload",type:"file",accept:"image/*",onChange:function(e){if(e.target.files&&e.target.files.length>0){var t=new FileReader;t.addEventListener("load",(function(){return d(t.result)})),t.readAsDataURL(e.target.files[0])}},className:"hidden"})]})]}),Object(u.jsx)("div",{className:"hidden",children:Object(u.jsx)("canvas",{ref:h,style:{width:Math.round(null!==(t=null===g||void 0===g?void 0:g.width)&&void 0!==t?t:0),height:Math.round(null!==(r=null===g||void 0===g?void 0:g.height)&&void 0!==r?r:0),margin:"auto"}})}),Object(u.jsx)("p",{className:"text-s text-red-800",children:N}),Object(u.jsx)("div",{className:"md:flex md:justify-end md:mb-3",children:Object(u.jsx)(C,{type:"button",onClick:function(){if((null===g||void 0===g?void 0:g.width)&&(null===g||void 0===g?void 0:g.height))try{P(!0),a()}catch(N){P(!1),k(N.message)}else k("Please include a photo.")},styling:"w-full mt-3 md:w-max",text:"Submit",isLoading:L})})]})]})}function Ue(e){var t=e.target,r=e.setTarget,s=e.maxLength,a=e.next,c=Object(n.useState)(""),o=Object(i.a)(c,2),l=o[0],d=o[1];return Object(u.jsxs)("div",{children:[Object(u.jsx)("h1",{className:"text-3xl mb-2",children:"Great! Who has the power to make this change?"}),Object(u.jsx)("p",{className:"mb-4",children:"Choose the recipient(s) of your petition. These are people or organisations with the power to solve your problem or take the action you\u2019re demanding."}),Object(u.jsx)("input",{name:"target",className:"long-text-area",value:t,placeholder:"Petition target",onChange:function(e){d(""),r(e.target.value)},maxlength:s}),Object(u.jsxs)("div",{className:"flex flex-row justify-between mt-2",children:[Object(u.jsx)("p",{className:"text-s text-red-800",children:l}),Object(u.jsx)("span",{className:"ml-auto mr-0",children:Number(s)-t.length})]}),Object(u.jsx)("div",{className:"md:flex md:justify-end md:mb-3",children:Object(u.jsx)(C,{text:"Continue",styling:"w-full mt-4 md:w-min md:float-right",onClick:function(){t.length?a():d("Please add a decision maker.")}})})]})}function Ae(e){var t=e.title,r=e.setTitle,s=e.maxLength,a=e.next,c=Object(n.useState)(""),o=Object(i.a)(c,2),l=o[0],d=o[1];return Object(u.jsxs)("div",{children:[Object(u.jsx)("h1",{className:"text-3xl mb-2",children:"Write your petition title"}),Object(u.jsx)("p",{className:"mb-4",children:"This is the first thing that people will see about your petition. Get their attention with a short title that focusses on the change you'd like them to support."}),Object(u.jsx)("textarea",{name:"title",className:"long-text-area",rows:"2",value:t,placeholder:"What do you want to achieve?",onChange:function(e){d(""),r(e.target.value)},maxLength:s}),Object(u.jsxs)("div",{className:"flex flex-row justify-between",children:[Object(u.jsx)("p",{className:"text-s text-red-800",children:l}),Object(u.jsx)("span",{className:"mr-0 ml-auto",children:Number(s)-t.length})]}),Object(u.jsx)("div",{className:"md:flex md:justify-end md:mb-3",children:Object(u.jsx)(C,{text:"Continue",styling:"w-full mt-4 md:w-min",onClick:function(){t.length?a():d("Please write a headline.")}})})]})}var Re=function(e,t,r,n){return e.map((function(e,s){return function(e,n){return n[e]?Object(u.jsx)("button",{className:"rounded-full w-10 h-10 border-2 border-theme-red text-md ".concat(t===e?"bg-theme-red text-white":"bg-theme-white text-theme-red"),onClick:function(){return r(e)},children:t===e?e+1:"\u2713"}):Object(u.jsx)("button",{className:"rounded-full w-10 h-10 border-2 text-md ".concat(t===e?"border-theme-red bg-theme-red text-white":"bg-theme-white border-gray-500 text-gray-500"),onClick:n[e-1]?function(){r(e)}:function(){},children:e+1})}(s,n)}))};function Te(){var e=Object(I.c)(z),t=Object(n.useState)([0,0,0,0]),r=Object(i.a)(t,2),s=r[0],a=r[1],c=Object(n.useState)(0),o=Object(i.a)(c,2),d=o[0],j=o[1],h=Object(n.useState)(new G),b=Object(i.a)(h,2),m=b[0],x=b[1],p=Object(n.useState)(null),f=Object(i.a)(p,2),O=f[0],g=f[1],v=Object(l.g)(),w=function(e){return function(t){x(Object(Se.a)(Object(Se.a)({},m),{},Object(L.a)({},e,t)))}},y=function(e){var t=Object(H.a)(s);t[e]=1,a(t),j(e+1)},N=[Object(u.jsx)(Ae,{title:m.title,setTitle:w("title"),maxLength:"90",next:function(){return y(0)}}),Object(u.jsx)(Ue,{target:m.target,setTarget:w("target"),maxLength:"100",next:function(){return y(1)}}),Object(u.jsx)(Ie,{description:m.description,setDescription:w("description"),recommendedLength:"1000",next:function(){return y(2)}}),Object(u.jsx)(Ee,{photo:O,setPhoto:g,next:function(){if(!(m.title&&m.target&&m.description&&O&&"hasUser"===e.status))throw console.log([m.title,m.target,m.description,O,"hasUser"===e.status]),new Error("Please fill in all the fields.");var t=Object(Se.a)(Object(Se.a)({},m),{},{author:e.data.uid});ae(t,O).then((function(e){v.push("/proposal/".concat(e))}))}})];return Object(u.jsxs)("div",{children:[Object(u.jsx)("div",{className:"flex flex-row justify-evenly py-12 px-10 w-96 mx-auto",children:Re([1,2,3,4],d,j,s)}),Object(u.jsx)("div",{className:"px-2 md:w-768px mx-auto",children:N[d]})]})}function Be(){return Object(u.jsx)("div",{children:Object(u.jsxs)("div",{className:"mx-10 md:w-600px md:mx-auto mt-40 bg-red-100 p-8 text-red-800 space-y-3",children:[Object(u.jsx)("h1",{children:"We couldn't find the page you were looking for. "}),Object(u.jsx)("p",{children:"The URL may have been incorrect or the page may have been deleted."}),Object(u.jsxs)("p",{children:["Return to the"," ",Object(u.jsx)("span",{className:"text-theme-red hover:text-red-800",children:Object(u.jsx)(o.b,{to:"/",children:"homepage"})}),"."]})]})})}function Fe(){return Object(u.jsx)("div",{className:"h-48 bg-gray-100 px-2 w-full border-t border-gray-300 pt-5 text-gray-500",children:Object(u.jsxs)("div",{className:"w-full h-full mx-auto md:w-768px text-sm flex flex-col",children:[Object(u.jsxs)("p",{children:["This website is a clone of"," ",Object(u.jsx)("a",{className:"text-theme-red-dark hover:text-gray-500 underline",href:"change.org",children:"change.org"}),", made for the final project of"," ",Object(u.jsx)("a",{className:"text-theme-red-dark hover:text-gray-500 underline",href:"theodinproject.com",children:"The Odin Project"}),"'s ","javascript course."]}),Object(u.jsx)("p",{className:"mt-1",children:"Built from scratch with React + Redux, Tailwind and Firebase, and bootstrapped with create-react-app."}),Object(u.jsx)("span",{className:"w-full border-b border-gray-300 block mt-auto mb-2"}),Object(u.jsxs)("p",{className:"mt-1",children:["Created by"," ",Object(u.jsx)("a",{className:"text-theme-red-dark hover:text-gray-500 underline",href:"https://github.com/nyoos",children:"Sun I"})]}),Object(u.jsx)("p",{className:"mb-5 mt-1",children:"Content and images were taken from change.org."})]})})}var ze=function(){var e=Object(n.useState)(!1),t=Object(i.a)(e,2),r=t[0],s=t[1],a=Object(I.c)(z),c=Object(I.b)();return Object(n.useEffect)((function(){c(A())}),[c]),Object(n.useEffect)((function(){"hasUser"===a.status&&s(!1)}),[a]),Object(u.jsx)(o.a,{basename:"/change-clone",children:Object(u.jsxs)("div",{className:"text-theme-black font-medium h-full",children:[Object(u.jsx)(K,{showLogin:function(){return s(!0)}}),Object(u.jsx)(Q,{showLogin:r,closeLogin:function(){return s(!1)}}),Object(u.jsxs)("div",{className:"min-h-screen -mb-48",children:[Object(u.jsx)("div",{className:"App mt-14 mb-2",children:Object(u.jsxs)(l.d,{children:[Object(u.jsx)(l.b,{exact:!0,path:"/",render:function(){return Object(u.jsx)(fe,{})}}),Object(u.jsx)(l.b,{exact:!0,path:"/proposal/:proposalId",children:Object(u.jsx)(Ne,{showLogin:function(){return s(!0)}})}),Object(u.jsx)(l.b,{exact:!0,path:"/create_proposal",component:Te}),Object(u.jsx)(l.b,{exact:!0,path:"/user/:userId",component:Ce}),Object(u.jsx)(l.b,{exact:!0,path:"/404",component:Be}),Object(u.jsx)(l.a,{to:"/404"})]})}),Object(u.jsx)("div",{className:"h-48 block"})]}),Object(u.jsx)(Fe,{})]})})},De=Object(P.a)({reducer:{user:F}});c.a.render(Object(u.jsx)(s.a.StrictMode,{children:Object(u.jsx)(I.a,{store:De,children:Object(u.jsx)(ze,{})})}),document.getElementById("root"))}},[[751,1,2]]]);
//# sourceMappingURL=main.ce410023.chunk.js.map